# Predicting Song Genres with Audio Features

This is a project to see if it's possible to predict the genres of songs based on their audio characteristics. 

## Notebooks
- track_modeling
This notebook performs supervised learning techniques in an attempt to predict song genre. It requires a csv file labeled audio_features_4.0_clean.csv, which is stored in the data directory. After the initial model training, a few visualizations are provided to see how the models performed and suggest directions for future modeling work.

- get_song_stats
This notebook contains to code for downloading the relevant data from the Spotify Web API, which is a lengthy process. You can acquire your own client_id and client_secret from Spotify's developer portal (requires sign-up). It stores the downloaded data in a SQLite db file in the same directory, and provides code for exporting that file to csv, which is needed for the data cleaning notebook.

- get_popularity
This is a supplementary notebook to get the popularity rating for Spotify tracks. (This was an exploratory step in the project that was added later.) If you want to run this notebook, you'll need the SQLite db file generated by running get_song_stats.

- track_cleaning
This notebook shows the data cleaning proccess and documents the choices that were made. It takes the audio_features_4.0.csv file generated by get_song_stats, and outputs a csv file called audio_features_4.0_clean.csv.

## Visualizations

This graph shows the overall scores that the random forest model was able to achieve for the different genres in the dataset. The reported metric is "f1-score," which is a weighted average of precision and recall. (Precision measures the fraction of true positive instances among the instances that the classifier predicted as positive, while recall measures the fraction of true positive instances among all actual positive instances in the dataset.)

![image](https://user-images.githubusercontent.com/106289788/232366449-77335181-ed8d-452c-8c84-614bc763e0cf.png)

Here are precision and recall as a function of available datapoints for each genre. The random forest model is able to achieve greater precision with additional datapoints, but the relationship does not hold true for recall. There is some more discussion of this in the track_modeling notebook.

![image](https://user-images.githubusercontent.com/106289788/232366908-a4a57953-70d1-4c12-90ee-1adb069c1dac.png)

This Sankey flow diagram shows the runner-up classes that were predicted by the model. This graph uses a sum of predicted probabilities for each genre, which differs from precision/recall, as it rewards the model being confident when it is correct. There are graphs for a few selected genres in track_modeling; this one shows the distribution of prediction for Progressive House music.

![newplot](https://user-images.githubusercontent.com/106289788/232368304-9c298e76-aa34-4ddf-81ab-e5905cc68b08.png)

Finally, here's the distribution of the different audio features provided by Spotify.

![image](https://user-images.githubusercontent.com/106289788/232368575-364cb034-f096-46f8-b049-3ff6009f2f3a.png)


